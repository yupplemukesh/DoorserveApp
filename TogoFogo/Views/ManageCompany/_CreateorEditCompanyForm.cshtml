@model TogoFogo.Models.Company.CompanyModel
@{
    var cs = "active in";

    var act = "";
    if (Model.Action == 'I')
    {
        act = "isDisabled";
    }

}
@Html.HiddenFor(x=>x.Path)
<div class="panel panel-default panel-table">
    <div class="panel-body">
        <div class="panel panel-default panel-table">
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3 ">
                        <ul class="nav nav-pills company-tabs m-b-15" id="tabs">
                            @if (Model.ActiveTab == "tab-1")
                            {
                                <li class="active">
                                    <a href="#tab-3" role="tab"  data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-4" role="tab" class="@act" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li>
                                    <a href="#tab-5" role="tab" class="@act"  data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-6" role="tab" class="@act" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-7" class="@act" role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-8" role="tab" class="@act" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>
                            }
                            else if (Model.ActiveTab == "tab-2")
                            {
                                <li>
                                    <a href="#tab-3" role="tab" data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li class="active">
                                    <a href="#tab-4"  role="tab" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li>
                                    <a href="#tab-5" class="@act" role="tab" data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-6" class="@act" role="tab" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-7" class="@act" role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-8" class="@act" role="tab" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>


                            }
                            else if (Model.ActiveTab == "tab-3")
                            {

                                <li>
                                    <a href="#tab-3" role="tab" data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-4" role="tab" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li class="active">
                                    <a href="#tab-5" role="tab" data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-6" role="tab" class="@act" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-7" class="@act"  role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-8" class="@act" role="tab" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>

                            }

                            else if (Model.ActiveTab == "tab-4")
                            {

                                <li>
                                    <a href="#tab-3" role="tab" data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-4" role="tab" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li>
                                    <a href="#tab-5" role="tab" data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li class="active">
                                    <a href="#tab-6" role="tab" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-7" class="@act" role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-8" class="@act" role="tab" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>

                            }

                            else if (Model.ActiveTab == "tab-5")
                            {

                                <li>
                                    <a href="#tab-3" role="tab" data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-4" role="tab" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li>
                                    <a href="#tab-5" role="tab" data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-6" role="tab" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li class="active">
                                    <a href="#tab-7" role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-8" class="@act" role="tab" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>

                            }

                            else
                            {
                                <li>
                                    <a href="#tab-3" role="tab" data-toggle="tab">
                                        Setting
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-4" role="tab" data-toggle="tab">
                                        Organization
                                    </a>
                                </li>
                                <li>
                                    <a href="#tab-5" role="tab" data-toggle="tab">
                                        Contact Person And Address
                                    </a>
                                </li>

                                <li>
                                    <a href="#tab-6" role="tab" data-toggle="tab">
                                        Bank Detail
                                    </a>
                                </li>

                                <li >
                                    <a href="#tab-7" role="tab" data-toggle="tab">
                                        Agreement
                                    </a>
                                </li>

                                <li class="active">
                                    <a href="#tab-8" role="tab" data-toggle="tab">
                                        Registration
                                    </a>
                                </li>

                            }
                        </ul>

                    </div>
                    <div class="col-md-9">

                        <div class="tab-content">

                            @if (Model.ActiveTab == "tab-1")
                            {
                                @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-3">
                                }
                                else
                                {
                                    @:<div role="tabpanel" class="tab-pane fade" id="tab-3">
                                    }
                            <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">
                                <div class="panel-body p-t-0 ">
                                    <h4 class="p-b-10"> Admin Panel : </h4>
                                    @using (Html.BeginForm("AddorEditCompany", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                                    {
                                        @Html.HiddenFor(x => x.CompanyId)
                                        @Html.HiddenFor(x => x.ActiveTab)
                                        @Html.HiddenFor(x => x.Action)
                                        @Html.HiddenFor(x => x.CurrentCompanyName)
                                        @Html.HiddenFor(x => x.CompanyLogo)
                                        @Html.Partial("~/Views/ManageCompany/_AddOrEditCompany.cshtml")
                                        <div class="form-group row m-b-25">
                                            <div class="col-sm-offset-11  col-md-1">
                                                <button type="submit" class="btn btn-success" style="">Save</button>
                                            </div>

                                        </div>
                                    }
                                </div>
                            </div>
                        </div>

                        @if (Model.ActiveTab == "tab-2")
                        {
                            @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-4">
                            }
                            else
                            {
                                @:<div role="tabpanel" class="tab-pane fade" id="tab-4">
                                }
                        <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">

                            <div class="panel-body p-t-0">

                                <h4 class="p-b-10"> Organization Code : </h4>
                                @using (Html.BeginForm("AddorEditOrganizaion", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                                {
                                    Model.Organization.RefKey = Model.CompanyId;
                                    @Html.Partial("~/Views/Common/_AddOrEditOrginazation.cshtml", Model.Organization)
                                    <div class="form-group row m-b-25">
                                        <div class="col-sm-offset-11  col-md-1">
                                            <button type="submit" class="btn btn-success" style="">Save</button>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>
                    </div>
                    @if (Model.ActiveTab == "tab-3")
                    {
                        @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-5">
                        }
                        else
                        {
                            @:<div role="tabpanel" class="tab-pane fade" id="tab-5">
                            }
                    <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">
                        <div class="panel-body p-t-0">
                            <div class="form-group">
                                <div class="col-md-3 p-l-0"><h4 class="p-b-10"> Contact Person : </h4></div>
                                <div class="col-md-2 col-md-offset-7">
                                    <button type="button" class="btn btn-success btn-sm " id="AddContactPerson">Add Contact Person</button>
                                </div>
                                @Html.Partial("~/Views/Common/_ContactDetails.cshtml", Model.Contacts)
                                <div class="row" style="display:none" id="ContactPerson">
                                    @using (Html.BeginForm("AddOrEditContactPerson", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                                    {
                                        Model.Contact.RefKey = Model.CompanyId;
                                        <div class="col-12">
                                            @Html.Partial("~/Views/Common/_AddEditContactPerson.cshtml", Model.Contact)
                                        </div>
                                        <div class="form-group row m-b-25">
                                            <div class="col-sm-offset-11  col-md-1">
                                                <button type="submit" class="btn btn-success" style="">Save</button>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    @if (Model.ActiveTab == "tab-4")
                    {

                        @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-6">
                        }
                        else
                        {
                            @:<div role="tabpanel" class="tab-pane fade" id="tab-6">
                            }
                    <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">
                        <div class="panel-body p-t-0">
                            <div class="form-group">
                                <div class="col-md-3 p-l-0"><h4 class="p-b-10"> Bank Details: </h4></div>
                                <div class="col-md-2 col-md-offset-7">
                                    <button type="submit" class="btn btn-success btn-sm " id="AddBankAccount">Add Bank Account</button>
                                </div>
                            </div>
                            <div class="row">
                                <div class=" col-md-12">
                                    @Html.Partial("~/Views/Common/_bankDetails.cshtml", Model.BankDetails)
                                </div>
                            </div>
                            <div class="row" style="display:none" id="BankAccount">
                                @using (Html.BeginForm("AddOrEditBank", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                                {
                                    Model.BankDetail.RefKey = Model.CompanyId;
                                    <div class="col-12">
                                        @Html.Partial("~/Views/Common/_AddOrUpdateBankDetails.cshtml", Model.BankDetail)

                                    </div>

                                    <div class="form-group row m-b-25">
                                        <div class="col-sm-offset-11  col-md-1">
                                            <button type="submit" class="btn btn-success" style="">Save</button>
                                        </div>
                                    </div>
                                }
                            </div>

                        </div>
                    </div>
                    </div>


                    @if (Model.ActiveTab == "tab-5")
                    {

                        @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-7">
                        }
                        else
                        {
                            @:<div role="tabpanel" class="tab-pane fade" id="tab-7">
                            }
                    <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">
                        <div class="panel-body p-t-0">
                            <div class="form-group">
                                <div class="col-md-12 p-l-0"><h4 class="p-b-10"> Agreement: </h4></div>
                                @using (Html.BeginForm("AddorEditAgreement", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                                {
                                    Model.Agreement.RefKey = Model.CompanyId;
                                    @Html.Partial("~/Views/ManageCompany/_Agreement.cshtml", Model.Agreement)
                                    <div class="form-group row m-b-25">
                                        <div class="col-sm-offset-11  col-md-1">
                                            <button type="submit" class="btn btn-success" style="">Save</button>
                                        </div>
                                    </div>
                                }
                            </div>


                        </div>
                    </div>
                    </div>

                    @if (Model.ActiveTab == "tab-6")
                    {

                        @:<div role="tabpanel" class="tab-pane fade @cs" id="tab-8">
                        }
                        else
                        {
                            @:<div role="tabpanel" class="tab-pane fade" id="tab-8">
                            }




                    <div class="panel panel-default panel-table  b-r-0 b-b-0 b-left-side">
                        <div class="panel-body p-t-0">
                            @using (Html.BeginForm("Registration", "ManageCompany", FormMethod.Post, new { enctype = "multipart/form-data", id = "contactform" }))
                            {
                                @Html.HiddenFor(x => x.Action)
                                @Html.HiddenFor(x => x.CompanyId)
                                @Html.Partial("~/Views/ManageCompany/_Registration.cshtml", Model)
                                <div class="form-group row m-b-25">
                                    <div class="col-sm-offset-11  col-md-1">
                                        <button type="submit" class="btn btn-success">Save</button>
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    </div>
                    @Scripts.Render("~/bundles/jquery")
                    @Scripts.Render("~/bundles/jqueryval")
                    <script>
                        var DivName = $('.nav-tabs .active a').attr('href');
                        activaTab(DivName);

                        function activaTab(tab) {

                            $(tab).addClass("active in");
                        };
                        $("#AddContactPerson").click(function () {
                            $('#ContactPerson').find(':input,select').each(function () {
                                debugger
                                switch (this.type) {
                                    case 'button':
                                    case 'text':
                                    case 'submit':
                                    case 'password':
                                    case 'file':
                                    case 'email':
                                    case 'date':
                                    case 'number':
                                        $(this).val('');
                                        break;
                                    case 'select-one':
                                        $(this).val('');
                                        break;
                                    case 'checkbox':
                                    case 'radio':
                                        this.checked = false;
                                        break;
                                }

                                $("#ContactId").val('');

                            })
                            $("#ContactPerson").show();
                        });



                        $("#AddBankAccount").click(function () {
                            $('#BankAccount').find(':input,select').each(function () {
                                debugger
                                switch (this.type) {
                                    case 'button':
                                    case 'text':
                                    case 'submit':
                                    case 'password':
                                    case 'file':
                                    case 'email':
                                    case 'date':
                                    case 'number':
                                        $(this).val('');
                                        break;
                                    case 'select-one':
                                        $(this).val('');
                                        break;
                                    case 'checkbox':
                                    case 'radio':
                                        this.checked = false;
                                        break;
                                }

                                $("#bankId").val('');

                            })

                            $("#BankAccount").show();
                        });
                        function AjaxWithValue(method, ddl, e) {
                            var val = e.value;
                            var other = e.Other;
                            console.log(other);
                            $.ajax({
                                type: "GET",
                                url: "/DropdownBind/" + method + "?value=" + val,
                                data: '{}',
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {
                                    $("#" + ddl).empty();

                                    //var sel = new Option('-Select-', '');
                                    //$('#' + ddl).append(sel);
                                    for (var i = 0; i < data.length; i++) {
                                        var opt = new Option(data[i].Text, data[i].Value);
                                        $('#' + ddl).append(opt);
                                    }

                                    if (other != undefined) {
                                        $('#' + ddl).val(other);

                                    }

                                }
                            });
                        }
                        function getItems(Id, method) {
                            var val = Id;
                            $.ajax({
                                type: "GET",
                                url: "/DropdownBind/" + method + "?Id=" + val,
                                data: '{}',
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                success: function (data) {

                                    if (method == 'JsonGetBank') {
                                        $("#bankId").val(data.bankId);
                                        $("#BankNameId").val(data.BankNameId);
                                        $("#BankAccountNumber").val(data.BankAccountNumber);
                                        $("#BankCompanyName").val(data.BankCompanyName);
                                        $("#BankIFSCCode").val(data.BankIFSCCode);
                                        $("#BankBranchName").val(data.BankBranchName);
                                        $("#IsDefault").prop("checked", data.isDefault);
                                        $("#BankCancelledChequeFileName").val(data.BankCancelledChequeFileName);
                                        if (data.BankCancelledChequeFileName != null || data.BankCancelledChequeFileName != "") {
                                            $("#conBankImg").prop("src", $("#Path").val() + "/Cheques/" + data.BankCancelledChequeFileName);
                                        }
                                        $("#BankAccount").show();
                                    }
                                    else {
                                        $("#ContactId").val(data.ContactId);
                                        $("#ConAdhaarFileName").val(data.ConAdhaarFileName);
                                        $("#ConVoterIdFileName").val(data.ConVoterIdFileName);
                                        $("#ConPanFileName").val(data.ConPanFileName);
                                        $("#ConFirstName").val(data.ConFirstName);
                                        $("#ConEmailAddress").val(data.ConEmailAddress);
                                        $("#CurrentEmail").val(data.ConEmailAddress);
                                        $("#ConLastName").val(data.ConLastName);
                                        $("#ConMobileNumber").val(data.ConMobileNumber);
                                        $("#ConPanNumber").val(data.ConPanNumber);
                                        $("#ConVoterId").val(data.ConVoterId);
                                        $("#ConAdhaarNumber").val(data.ConAdhaarNumber);
                                        $("#AddressTypeId").val(data.AddressTypeId);
                                        $("#ConAdhaarFileName").val(data.ConAdhaarFileName);
                                        $("#ConVoterIdFileName").val(data.ConVoterIdFileName);
                                        $("#ConPanFileName").val(data.ConPanFileName);
                                        if (data.ConAdhaarFileName != null || data.ConAdhaarFileName != "") {
                                            $("#conAdhrImg").prop("src", $("#Path").val() + "/ADHRs/" + data.ConAdhaarFileName);
                                        }
                                        if (data.ConVoterIdFileName != null || data.ConVoterIdFileName != "") {
                                            $("#conVoterImg").prop("src", $("#Path").val() + "/VoterIds/" + data.ConVoterIdFileName);
                                        }

                                        if (data.ConPanFileName != null || data.ConPanFileName != "") {
                                            $("#conPanImg").prop("src", $("#Path").val() + "/PanCards/" + data.ConPanFileName);
                                        }
                                        $("#CurrentIsUser").val(data.CurrentIsUser);
                                        $("#CountryId").val(data.CountryId);
                                        var obj = { value: data.CountryId, Other: data.StateId };
                                        AjaxWithValue('BindStateJson', 'StateId', obj);
                                        obj.value = data.StateId;
                                        obj.Other = data.CityId;
                                        AjaxWithValue('BindLocationJson', 'CityId', obj);
                                        $("#Address").val(data.Address);
                                        $("#Locality").val(data.Locality);
                                        $("#NearLocation").val(data.NearLocation);
                                        $("#PinNumber").val(data.PinNumber);
                                        $("#IsUser").prop("checked", data.isUser);
                                        $("#ContactPerson").show();
                                    }

                                }
                            });
                        }
                    </script>

